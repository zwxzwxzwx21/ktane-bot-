import os
import cv2
import numpy as np
import pyautogui
import time


def distance_to_colors(pixel):
    white = np.array([255, 255, 255])
    black = np.array([0, 0, 0])
    distance_to_white = np.linalg.norm(pixel - white)
    distance_to_black = np.linalg.norm(pixel - black)
    return distance_to_white, distance_to_black


def take_and_display_screenshot(x, y, width, height):
    screenshot = pyautogui.screenshot(region=(x, y, width, height))

    screenshot_np = np.array(screenshot)
    my_image = cv2.cvtColor(screenshot_np, cv2.COLOR_RGB2BGR)
    check_array = ''
    number_LUT = {
        '001100011100010010111111100001': 'A',
        '111110100011111110100001111100': 'B',
        '011101100001100000100001011110': 'C',
        '011101100001100000100001011100': 'C',
        '111110100001100001100011111100': 'D',
        '111111100000111110100000111111': 'E',
        '111111100000111110100000100000': 'F',
        '011101100001100111100001011110': 'G',
        '011101100001100111100001011100': 'G',
        '100011100011111111100011100011': 'H',
        '011110001100001100001100011110': 'I',
        '011110001000001000001000011110': 'I',
        '000011000011000011100010011100': 'J',
        '000011000011000011100011011100': 'J',
        '100010101100111000100110100011': 'K',
        '100010101100111000100100100011': 'K',
        '100000100000100000100000111111': 'L',
        '110011110111101111100011100011': 'M',
        '110011111011101111100111100011': 'N',
        '111110100001111110100000100000': 'P',
        '111110100001111110100100100011': 'R',
        '011110100001100001100011011100': 'Q',
        '011110100010001110100011101110': 'S',
        '011111100011001110100011101110': 'S',
        '111111101001001000001000011110': 'T',
        '111111101101001100001100011110': 'T',
        '100011100011100011100011011100': 'U',
        '100001100011010010011100001100': 'V',
        '100001100001101111110110010010': 'W',
        '110111010110001100010110110111': 'X',
        '111110100110001000010011111111': 'Z',
        '111110100110001100010011111111': 'Z',

        '011110100011101001100011011100': '0',

        '001000111000001000001000011110': '1',
        '011110100011000110011011111111': "2",
        '011110100011001110100011011110': "3",
        '000100011100100100000100001111': '4',
        '000100011100100100000110001111': '4',
        '111110100000110011100011011100': '5',
        '011110100000100011100001011110': '6',
        '111111100010000100001000001000': '7',
        '011110100011011110100001011110': '8',
        '011110100011100011000011011100': "9"
    }
    # only number here, made on 3rd pos
    N_LUT = {

        '011110100011101001100011011100': '0',
        '001000111000001000001000011110': '1',
        '011110100011000110011011111111': "2",
        '011110100011001110100011011110': '3',
        '000100011100100100000110001111': '4',
        '111110100000110011100001011100': "5",
        '111110100000110011100011011100': '5',
        '011110100000100011100001011110': '6',
        '111111100010000100001000001000': '7',
        '011110100011011110100001011110': '8',
        '011110100011100011000011011100': '9',
        '011110100001100011000011011100': '9'
    }
    # ONLY ON 6 POS HERE
    N_LUT2 = {

        '011110100011101001110001011100': '0',
        '011110100011101001110011011100': '0',
        '001100111100001100001100011110': '1',
        '011110100011000110011011111111': '2',
        '011110100011001110100001011110': '3',
        '000110011110100110000110001111': '4',
        '111111100000110011100001011100': '5',
        '011110100000100011100001011110': '6',
        '111111100010000100001000001000': '7',
        '011110100011011110100001011110': '8',
        '011110100001110011000011011100': '9'

    }

    for j in range(5):
        for i in range(6):
            dot_x, dot_y = 4 + i * 4, 2 + j * 8
            my_image[dot_x, dot_y] = (0, 0, 255)
            screen_pixet_rgb = pyautogui.pixel(x + dot_x, y + dot_y)

            distance_to_white, distance_to_black = distance_to_colors(np.array(screen_pixet_rgb))
            closer_color = "white" if distance_to_white < distance_to_black else "black"
            if closer_color == "white":
                check_array += '0'
            else:
                check_array += '1'

    try:
        if x != 1825:
            if x != 1915:
                print(number_LUT[check_array])
            else:
                print(N_LUT2[check_array])
        else:
            print(N_LUT[check_array])

    except KeyError:
        print(check_array, 'not in LUT')


for i in range(6):
    y = 61
    if i == 0:
        x = 1765
    elif i == 1:
        x = 1795
    elif i == 2:
        x = 1825
    elif i == 3:
        x = 1855
    elif i == 4:
        x = 1885
    elif i == 5:
        x = 1915
    width, height = 176, 45
    take_and_display_screenshot(x, y, width, height)

